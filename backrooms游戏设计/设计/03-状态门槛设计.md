# 状态门槛设计

## 设计理念

**某些节点/选项需要满足条件才能进入，用变量+Blockly实现门槛判断**

不是所有内容第一次玩就能看到，鼓励探索和重玩。

---

## mo编辑器实现

**节点的Blockly脚本判断条件**:
```
如果 has_rope = true
  → 显示选项 "使用绳索安全通过Drop Maze"
否则
  → 只显示 "尝试跳过（危险）"
```

---

## 案例1：绳索门槛

### 场景：Drop Maze遭遇

**节点**: Level2_DropMaze

**文本**:
```
前方地板突然中断。

虚空。黑暗的深渊。你看不到底部。

对面是3米外的另一段走廊。
```

**选项（根据变量动态）**:

```javascript
// Blockly脚本
if (vars['has_rope']) {
  // 显示选项A
} else {
  // 隐藏选项A
}
```

- **选项A**（需要绳索）: "使用绳索安全通过" → 100%成功
- **选项B**（无条件）: "助跑跳过" → 需要体力检定
- **选项C**（无条件）: "寻找其他路径" → 返回

---

## 案例2：知识门槛

### 场景：Smiler第二次遭遇

**变量**: `has_seen_smiler = true`（第一次遭遇后设置）

**节点**: Level0_SmilerAgain

**第一次遭遇**（没有该变量）:
```
你看到黑暗中的笑容，不知道那是什么，恐慌中逃跑。
【选项】盲目逃跑 / 尝试攻击 / 站着不动
```

**第二次遭遇**（有该变量）:
```
你看到那熟悉的笑容——Smiler。

这次你知道怎么对付它了。

【选项】
→ 用手电筒照射（正确应对）
→ 缓慢后退
→ 逃跑
```

**为什么有效**: 玩家第一次"学到"知识，第二次"应用"知识。

---

## 案例3：探索门槛

### Level 4的隐藏房间

**条件**: 访问Level 4超过3次（变量`level4_visit_count >= 3`）

**触发**:
```
Level4_Hub节点的Blockly脚本:

if (vars['level4_visit_count'] >= 3) {
  // 添加新热区："你注意到墙角有扇不起眼的门..."
  // 热区 → Level4_SecretRoom
}
```

**玩家体验**:
- 前3次访问Level 4，看不到这扇门
- 第3次访问后，突然发现新热区
- 点击进入，发现隐藏储藏室，有额外物资

**为什么有效**: 奖励熟悉环境的玩家，制造"发现"的惊喜。

---

## 案例4：结局门槛

### "逃离"结局的条件

**需要同时满足**:
```javascript
vars['explored_levels'] >= 5  // 探索至少5个层级
vars['noclip_mastery'] = true  // 学会高级Noclip
vars['found_exit_clue'] = true // 发现出口线索
vars['sanity_high'] = true     // 理智保持高位
```

**结局入口节点**: Level11_ExitDiscovery

**Blockly判断**:
```
如果 所有条件满足
  → 显示 "你发现了一扇奇怪的门..."（通往逃离结局）
否则
  → 该门不存在，玩家看不到
```

---

## 设计原则

✓ **首次游玩不强求全收集** - 第一次玩到某个结局就好  
✓ **重玩发现新内容** - 第二次玩发现有新选项  
✓ **知识即奖励** - "我知道怎么对付Smiler"是成就感  
✓ **变量记录进度** - 探索次数、遭遇经历都是门槛

---

## 变量命名建议

```
物品类: has_rope, has_flashlight_battery
知识类: has_seen_smiler, knows_level4_location
进度类: level4_visit_count, explored_levels
状态类: sanity_high, helped_survivor
```

简单的true/false或数字，不做复杂计算。

