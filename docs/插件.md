# 插件系统

## 核心架构

**跨端共享** - PluginSystem在前后端通用，插件代码零重复

**钩子机制** - 50+钩子覆盖引擎、编辑器、播放器全生命周期

**单一职责** - CoreEngine只管节点跳转，所有业务逻辑由插件实现

## 插件分类

**shared/plugins/basicmod（基础模组）**
- RuntimePlugin - 变量存储、模板替换、函数注册
- BlocklyPlugin - 可视化编程积木块

**shared/plugins/tools（工具插件）**
- MarkdownPlugin - 富文本渲染
- ValidatorPlugin - 故事结构验证
- AnalyzerPlugin - 拓扑结构分析
- ChoiceEmbeddingPlugin - 内联选项超链接
- HierarchicalLayoutPlugin - 层次自动布局
- RadialLayoutPlugin - 辐射自动布局

**shared/plugins/gamemods（游戏模组）**
- TimeSystemPlugin - 时间流逝和自动进位（分→时→天→月）

**frontend/plugins（前端专用）**
- 主题插件 - Catppuccin/Nord/基础（编辑器配色）
- 样式插件 - 终端/视觉小说风格（播放器UI）

## 钩子扩展

**Blockly扩展钩子**
- blockly:register-blocks - 注册自定义积木块
- blockly:register-generators - 注册代码生成器

游戏模组通过这两个钩子动态扩展Blockly功能

## 导出机制

样式插件实现getCSS()方法，导出时自动注入到单文件HTML

